package com.dbconnection;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class Employee {

	public static void main(String[] args) throws SQLException {
		DataBaseconnection db = new DataBaseconnection();

		Connection connection = db.getConnection(); // Getting a Connection Using Object of Class

		/ *Creating a Statement(PreparedStatement) and Passing a SQL Query to a
		 Parameter */
		// Inserting a value
		PreparedStatement insert = connection.prepareStatement("insert into promo1(a,b) values(?,?)");

		insert.setString(1, "First");
		insert.setString(2, "Hello");
		insert.executeUpdate();

		// Deleting a value
		PreparedStatement delete = connection.prepareStatement("delete from promo1 where b=(?)");

		delete.setString(1, "Second");
		delete.executeUpdate();

		// Selecting a Value
		PreparedStatement select = connection.prepareStatement("select * from promo1");

		ResultSet rs = select.executeQuery();

		while (rs.next()) {
			System.out.println(rs.getString(1) + " " + rs.getString(2));

		}
	}

}
